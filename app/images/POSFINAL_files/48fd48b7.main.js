"use strict";Parse.initialize("LFJ3QGbWShkk4EL9OPC9RBzsM1beJbuSzZ3m8F0f","h9DNGD2Piozeww9Il1F9zS85gQh17uJXZnqf2l7V");var Data=Parse.Object.extend("Data"),User=Parse.Object.extend("User"),Order=Parse.Object.extend("Order"),Table=Parse.Object.extend("Table"),Report=Parse.Object.extend("Report"),DataCollection=Parse.Collection.extend({model:Data}),UserCollection=Parse.Collection.extend({model:User}),OrderCollection=Parse.Collection.extend({model:Order}),TableCollection=Parse.Collection.extend({model:Table}),ReportCollection=Parse.Collection.extend({model:Report}),currentUser,LoginView=Parse.View.extend({loginTemplate:_.template($(".login-template").text()),events:{"click .submit":"showLayoutView","click .admin":"showAdminView","click .checkout":"showReportView"},initialize:function(){$(".container").append(this.el),this.render()},render:function(){var a=this.loginTemplate();this.$el.html(a),$(".password").keypress(function(a){13===a.which&&$(".submit").click()})},showLayoutView:function(){new Parse.User;Parse.User.logIn($(".userlogin").val(),$(".password").val(),{success:function(a){a.set("username",$(".userlogin").text()),a.set("password",$(".password").val()),a.save(null,{success:function(a){var b=new Parse.Query(Parse.User);b.get(a.id,{success:function(){},error:function(){}})},error:function(){}}),currentUser=Parse.User.current();Parse.User.current()._sessionToken;currentUser&&(Parse.User.become(currentUser._sessionToken).then(function(a){Parse.User._saveCurrentUser(a)},function(){}),router.navigate("#/tables",{trigger:!0}))},error:function(a,b){alert("Error"+b.code+" "+b.message)}})},showAdminView:function(){router.navigate("#/admin",{trigger:!0})},showReportView:function(){router.navigate("#/report",{trigger:!0})}}),LayoutView=Parse.View.extend({layoutTemplate:_.template($(".layout-template").text()),events:{"click .hightop1":"showHightop1","click .hightop2":"showHightop2","click .table101":"showTable101","click .table102":"showTable102","click .table103":"showTable103","click .table104":"showTable104","click .booth201":"showBooth201","click .booth202":"showBooth202","click .booth203":"showBooth203","click .booth204":"showBooth204","click .stool1":"showStool1","click .stool2":"showStool2","click .stool3":"showStool3","click .stool4":"showStool4","click .stool5":"showStool5","click .stool6":"showStool6","click .stool7":"showStool7","click .stool8":"showStool8"},initialize:function(){$(".container").empty(),$(".container").append(this.el),this.render()},render:function(){var a=this.layoutTemplate(this.model);this.$el.html(a)},showHightop1:function(){var a=new Parse.Object("Table"),b=$(".hightop1").text();a.set("hightop1",b),a.save(),router.navigate("#categories",{trigger:!0})},showHightop2:function(){var a=new Parse.Object("Table"),b=$(".hightop2").text();a.set("hightop2",b),a.save(),router.navigate("#categories",{trigger:!0})},showTable101:function(){var a=new Parse.Object("Table"),b=$(".table101").text();a.set("table101",b),a.save(),router.navigate("#categories",{trigger:!0})},showTable102:function(){var a=new Parse.Object("Table"),b=$(".table102").text();a.set("table102",b),a.save(),router.navigate("#categories",{trigger:!0})},showTable103:function(){var a=new Parse.Object("Table"),b=$(".table103").text();a.set("table103",b),a.save(),router.navigate("#categories",{trigger:!0})},showTable104:function(){var a=new Parse.Object("Table"),b=$(".table104").text();a.set("table104",b),a.save(),router.navigate("#categories",{trigger:!0})},showBooth201:function(){var a=new Parse.Object("Table"),b=$(".booth201").text();a.set("booth201",b),a.save(),router.navigate("#categories",{trigger:!0})},showBooth202:function(){var a=new Parse.Object("Table"),b=$(".booth202").text();a.set("booth202",b),a.save(),router.navigate("#categories",{trigger:!0})},showBooth203:function(){var a=new Parse.Object("Table"),b=$(".booth203").text();a.set("booth203",b),a.save(),router.navigate("#categories",{trigger:!0})},showBooth204:function(){var a=new Parse.Object("Table"),b=$(".booth204").text();a.set("booth204",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool1:function(){var a=new Parse.Object("Table"),b=$(".stool1").text();a.set("stool1",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool2:function(){var a=new Parse.Object("Table"),b=$(".stool2").text();a.set("stool2",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool3:function(){var a=new Parse.Object("Table"),b=$(".stool3").text();a.set("stool3",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool4:function(){var a=new Parse.Object("Table"),b=$(".stool4").text();a.set("stool4",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool5:function(){var a=new Parse.Object("Table"),b=$(".stool5").text();a.set("stool5",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool6:function(){var a=new Parse.Object("Table"),b=$(".stool6").text();a.set("stool6",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool7:function(){var a=new Parse.Object("Table"),b=$(".stool7").text();a.set("stool7",b),a.save(),router.navigate("#categories",{trigger:!0})},showStool8:function(){var a=new Parse.Object("Table"),b=$(".stool8").text();a.set("stool8",b),a.save(),router.navigate("#categories",{trigger:!0})}}),OrderView=Parse.View.extend({className:"order",orderTemplate:_.template($(".order-template").text()),events:{},initialize:function(){$(".container").empty(),$(".container").append(this.el),this.render()},render:function(){var a=this.orderTemplate(this.model);this.$el.html(a)}}),ButtonView=Parse.View.extend({className:"button",buttonTemplate:_.template($(".button-template").text()),events:{click:"showCategoryName"},initialize:function(){$(".menu-buttons").append(this.el),this.render()},render:function(){var a=this.buttonTemplate(this.model);this.$el.html(a)},showCategoryName:function(){router.navigate("#/categories/"+this.model,{trigger:!0})}}),EntreeView=Parse.View.extend({className:"button",entreeTemplate:_.template($(".entree-template").text()),events:{click:"showPricing"},initialize:function(){$(".menu-buttons").append(this.el),this.render()},render:function(){var a=this.entreeTemplate(this.model);this.$el.html(a)},showPricing:function(){console.log("the button works");var a=new Parse.Object("Order"),b=this.model.name,c=this.model.price,d=$(".subtotal").text(),e=$(".taxtotal").text(),f=$(".totaltotal").text();a.set("runnername",b),a.set("runnerprice",c),a.set("subtotal",d),a.set("tax",e),a.set("total",f),a.save().done(function(){$(".menu-buttons").html(""),router.navigate("#categories",{trigger:!0})})}}),PaymentView=Parse.View.extend({paymentTemplate:_.template($(".payment-template").text()),events:{"click .credit-amex":"showLoginView","click .credit-visa":"showLoginView","click .credit-master":"showLoginView","click .credit-discover":"showLoginView","click .cash":"showCashModal","click .check":"showCashModal","click .gift":"showCashModal","click .manager":"showCashModal","click .numberenter":"showPaymentView"},initialize:function(){$(".container").empty(),$(".container").append(this.el),this.render()},render:function(){var a=this.paymentTemplate(this.model);this.$el.html(a),$("#modaloverlay").keypress(function(a){13===a.which&&$(".numberenter").click()})},showLoginView:function(){var a=new Parse.Query(Order);a.find({success:function(a){a.forEach(function(a){console.log(a),a.destroy({})})}}),router.navigate("#",{trigger:!0})},showCashModal:function(){var a=document.getElementById("overlay");a.style.visibility="visible"==a.style.visibility?"hidden":"visible"},showPaymentView:function(){var a=new Parse.Query(Order);a.find({success:function(a){a.forEach(function(a){console.log(a),a.destroy({})})}}),router.navigate("#",{trigger:!0})}}),AdminView=Parse.View.extend({adminTemplate:_.template($(".admin-template").text()),events:{"click .codeenter":"signUpUser","click .menuenter":"addMenuItem","click .menudone":"exitMenu","click .customdone":"addCustom"},initialize:function(){$(".container").empty(),$(".container").append(this.el),this.render()},render:function(){var a=this.adminTemplate(this.model);this.$el.html(a),$(".userpassword").keypress(function(a){13===a.which&&$(".codeenter").click()}),$(".price").keypress(function(a){13===a.which&&$(".menuenter").click()})},signUpUser:function(){var a=new Parse.User;a.set("username",$(".code").val()),a.set("password",$(".userpassword").val()),a.signUp(null,{success:function(){var a=Parse.User.current();a?(router.navigate("#",{trigger:!0}),console.log(a)):console.log("did not sign up")},error:function(a,b){alert("Error"+b.code+" "+b.message)}})},addMenuItem:function(){var a=new Parse.Object("Data"),b=$(".categorytitle").val(),c=$(".categoryname").val(),d=$(".price").val();a.set("category",b),a.set("name",c),a.set("price",d),a.save(),alert("New Menu Item Added Successfully")},addCustom:function(){var a=new Parse.Object("Data"),b=$(".customcat").val(),c=$(".customname").val(),d=$(".customprice").val();a.set("category",b),a.set("name",c),a.set("price",d),a.save(),alert("New Menu Item Added Successfully")},exitMenu:function(){router.navigate("#",{trigger:!0})}}),RunnerView=Parse.View.extend({runnerTemplate:_.template($(".runner-template").text()),events:{"click .go-button":"showLoginView","click .gostaybutton":"showReceiptView","click .pay":"showPaymentView"},initialize:function(){window.setInterval(function(){var a=document.getElementById("itemizer");a.scrollTop=a.scrollHeight},2e3),this.subtotal=0;var a=this;$(".container").append(this.el),this.render();var b=new OrderCollection;b.on("add",function(){}),b.fetch({add:!0}).done(function(){b.each(function(b){console.log(b),$("#itemizer").append(b.attributes.runnername+" $"+b.attributes.runnerprice),$("#itemizer").append("<br />"),a.subtotal+=parseFloat(b.attributes.runnerprice),console.log(a.subtotal);var c=parseFloat((6.75*a.subtotal/100).toFixed(2)),d=parseFloat((a.subtotal+c).toFixed(2));$(".subtotal").empty(),$(".subtotal").append(a.subtotal.toFixed(2)),$(".taxtotal").empty(),$(".taxtotal").append(c),$(".totaltotal").empty(),$(".totaltotal").append(d)})})},render:function(){var a=this.runnerTemplate(this.model);return this.$el.html(a),this},showLoginView:function(){Parse.User.logOut(),router.navigate("#",{trigger:!0})},showReceiptView:function(){router.navigate("#/receipt",{trigger:!0})},showPaymentView:function(){Parse.User.logOut(),router.navigate("#/payment",{trigger:!0})}}),ReportView=Parse.View.extend({reportTemplate:_.template($(".report-template").text()),events:{},initialize:function(){$(".container").html(""),$(".container").append(this.el),this.render()},render:function(){var a=this.reportTemplate(this.model);return this.$el.html(a),this}}),ReceiptView=Parse.View.extend({receiptTemplate:_.template($(".receipt-template").text()),events:{"click .printandstaybutton":"showOrderView","click .printbutton":"showLoginView"},initialize:function(){this.subtotal=0;var a=this;$(".container").html(""),$(".container").append(this.el),this.render();var b=new OrderCollection;b.on("add",function(){}),b.fetch({add:!0}).done(function(){b.each(function(b){console.log(b),$(".namebox").append(b.attributes.runnername+" $"+b.attributes.runnerprice),$(".namebox").append("<br />","<br />"),a.subtotal+=parseFloat(b.attributes.runnerprice),console.log(a.subtotal);var c=parseFloat((6.75*a.subtotal/100).toFixed(2)),d=parseFloat((a.subtotal+c).toFixed(2));$(".subtotalbox").empty(),$(".subtotalbox").append("$ "+a.subtotal.toFixed(2)),$(".taxbox").empty(),$(".taxbox").append("$ "+c),$(".receipttotal").empty(),$(".receipttotal").append("$ "+d)})})},render:function(){var a=this.receiptTemplate(this.model);return this.$el.html(a),this},showOrderView:function(){router.navigate("#/categories",{trigger:!0})},showLoginView:function(){router.navigate("#",{trigger:!0})}}),ProductRouter=Parse.Router.extend({routes:{"":"loginPage",payment:"paymentPage",admin:"adminPage",tables:"layoutPage",categories:"categoriesPage","categories/:category":"categoryPage",report:"reportsPage",receipt:"receiptPage"},initialize:function(){var a=new OrderCollection;a.on("add",function(){}),a.fetch({add:!0}).done(function(){a.each(function(){})})},adminPage:function(){$(".container").html(""),new AdminView},loginPage:function(){$(".container").html(""),new LoginView},layoutPage:function(){$(".container").html("");var a=new Parse.Query(Data),b=[];a.find({success:function(a){a.forEach(function(a){b.push(a.attributes.table),console.log(a.attributes.table)}),new LayoutView}})},categoriesPage:function(){$(".container").html(""),new OrderView,new RunnerView;var a=new Parse.Query(Data),b=[];a.find({success:function(a){a.forEach(function(a){b.push(a.attributes.category)}),b=_.union(b),b.forEach(function(a){new ButtonView({model:a})})}})},categoryPage:function(a){$(".menu-buttons").html("");var b=new Parse.Query(Data),c=[];b.equalTo("category",a),b.find({success:function(a){a.forEach(function(a){c.push(a.attributes.name),new EntreeView({model:a.attributes})})}})},paymentPage:function(){var a=$(".totaltotal").text();console.log(a),new PaymentView,$(".finalbalance").append("$"+a),$(".amountpaid").append("$"+a)},reportsPage:function(){$(".container").empty(),new ReportView},receiptPage:function(){$(".container").empty(),new ReceiptView}}),router=new ProductRouter;Parse.history.start();